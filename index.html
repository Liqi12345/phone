<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" >
	<title>Document</title>
	<script src="rem.js"></script>
	<script src="index.js"></script>
</head>

<style>
*{
	margin: 0;
	padding: 0;
	list-style: none;
}
/*body{
	background: #f6f6f6;
}*/
input{
	width: 100%;
	height: 1rem;
	display: block;
	font-size: 0.45rem;
	text-align: center;
	outline: none;
	box-sizing: border-box;
	border: 0;
	background-color: #e7e5e5;
	position: fixed;
	top: 0;
	left: 0;
	box-sizing: border-box;
	/*border-radius: 10px;*/
}
.box{
	margin-top: 1.7rem;
}

h3,.tops{
	width: 100%;
	height: 0.7rem;
	background: #f6f6f6;
	font-size: 0.3rem;
	line-height: 0.7rem;
	padding-left: 0.2rem;
	box-sizing: border-box;
}
.tops{
	position: fixed;
	top: 1rem;
	left: 0;
	background: #a0b9d0;
	font-size: 0.4rem;
	color:red;

}
a{
	display: block;
	color: #000;
	width: 100%;
	height: 1.3rem;
	background: #fff;
	font-size: 0.35rem;
	line-height: 1.3rem;
	padding-left: 0.2rem;
	text-decoration: none;
	-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
	border-bottom: 1px solid #999;
	box-sizing: border-box;
}
.dw{
	width: 0.6rem;
	height: auto;
	position: fixed;
	right: 0.5rem;
	top: 50%;
	font-size: 0.4rem;
	transform: translateY(-50%);
	border: 1px solid #000;
}
</style>

<body>
	<!-- <a href="tel:110"> 电话</a> -->
	<input type="text" placeholder="搜索">
	<div class="tops"></div>
	<div class="box">
		<!-- <h3>L</h3>
		<a href="tel:1735843485">李琪</a>
		<a href="tel:158358070485">李佳</a>
		<a href="tel:17635363485">刘震</a>
		<h3>Q</h3>
		<a href="tel:15034260765">乔美丽</a>
		<h3>W</h3>
		<a href="tel:18734445673">王晋玲</a>
		<h3>G</h3>
		<a href="tel:13994830308">哥哥</a>
		<h3>B</h3>
		<a href="tel:15138489444">爸爸</a> -->
		
	</div>
	<ul class="dw">
		
	</ul>
</body>
</html>
<script>
	// localStorage.phone = JSON.stringify(arr)
	$(function(){
		// let arr = [
		// {id:1,name:'李琪',phone:'1735843485',pinyin:'liqi'},
		// {id:2,name:'李佳',phone:'158358070485',pinyin:'lijia'},
		// {id:3,name:'刘震',phone:'17635363485',pinyin:'liuzhen'},
		// {id:1,name:'李琪',phone:'1735843485',pinyin:'liqi'},
		// {id:2,name:'李佳',phone:'158358070485',pinyin:'lijia'},
		// {id:3,name:'刘震',phone:'17635363485',pinyin:'liuzhen'},
		// {id:4,name:'乔美丽',phone:'15034260765',pinyin:'qiaomeili'},
		// {id:4,name:'乔美丽',phone:'15034260765',pinyin:'qiaomeili'},
		// {id:4,name:'乔美丽',phone:'15034260765',pinyin:'qiaomeili'},
		// {id:4,name:'乔美丽',phone:'15034260765',pinyin:'qiaomeili'},
		// {id:4,name:'乔美丽',phone:'15034260765',pinyin:'qiaomeili'},
		// {id:4,name:'乔美丽',phone:'15034260765',pinyin:'qiaomeili'},
		// {id:4,name:'乔美丽',phone:'15034260765',pinyin:'qiaomeili'},
		// {id:4,name:'乔美丽',phone:'15034260765',pinyin:'qiaomeili'},
		// {id:4,name:'乔美丽',phone:'15034260765',pinyin:'qiaomeili'},
		// {id:5,name:'王晋玲',phone:'18734445673',pinyin:'wangjinling'},
		// {id:5,name:'王晋玲',phone:'18734445673',pinyin:'wangjinling'},
		// {id:5,name:'王晋玲',phone:'18734445673',pinyin:'wangjinling'},
		// {id:5,name:'王晋玲',phone:'18734445673',pinyin:'wangjinling'},
		// {id:5,name:'王晋玲',phone:'18734445673',pinyin:'wangjinling'},
		// {id:6,name:'哥哥',phone:'13994830308',pinyin:'gege'},
		// {id:6,name:'哥哥',phone:'13994830308',pinyin:'gege'},
		// {id:6,name:'哥哥',phone:'13994830308',pinyin:'gege'},
		// {id:6,name:'哥哥',phone:'13994830308',pinyin:'gege'},
		// {id:6,name:'哥哥',phone:'13994830308',pinyin:'gege'},
		// {id:6,name:'哥哥',phone:'13994830308',pinyin:'gege'},
		// {id:7,name:'爸爸',phone:'15135489444',pinyin:'baba'},
		// {id:7,name:'爸爸',phone:'15135489444',pinyin:'baba'},
		// {id:7,name:'爸爸',phone:'15135489444',pinyin:'baba'},
		// {id:7,name:'爸爸',phone:'15135489444',pinyin:'baba'},
		// {id:7,name:'爸爸',phone:'15135489444',pinyin:'baba'},
		// {id:7,name:'爸爸',phone:'15135489444',pinyin:'baba'},
		// {id:7,name:'爸爸',phone:'15135489444',pinyin:'baba'},
		// ]
	
	// console.log(arr)
	// localStorage.phone = JSON.stringify(arr)
	// localStorage.setItem('phone',JSON.stringify(arr))
	let srr = JSON.parse(localStorage.getItem('phone'))
	let box = $('.box')[0];
	let dw = $('.dw')[0];
	let tops = $('.tops')[0];
	
	con(srr);

	let h = $('h3')
	// console.log(h)
	let search = $('input')[0];
	let hei = search.offsetHeight + tops.offsetHeight;

	let arr1 = [];
	Array.prototype.forEach.call(h,function(e){
			let htop = e.offsetTop;
			arr1.push(htop)
	})	

	window.addEventListener('scroll',function(){
		let srcolltops = document.documentElement.scrollTop;

		arr1.forEach(function(ele,index){
			if(hei + srcolltops >= ele){	
				tops.innerHTML = h[index].innerText;
			}
		})
	})


	search.addEventListener('input',function(){
		let inp = this.value.trim();
		let obj1 = srr.filter(ele =>ele.pinyin.includes(inp) || ele.name.includes(inp) || ele.phone.includes(inp))
		con(obj1)
	})
	

	function con(srr){
		// 创建obj对象存放首字母数组
		let obj = {};
		// 遍历每个JSON对象
		srr.forEach(function(ele){
			// 获取首字母
			let first = ele.pinyin.trim().charAt(0).toUpperCase();
			// 如果首字母里面是undefined
			if(!obj[first]){
				// first转为数组
				obj[first] = [];
			}
			// 数组里添加首字母是它的ele元素
			obj[first].push(ele)
			
		})
		// 获取首字母属性进行排列
		let key = Object.keys(obj).sort();

		tops.innerText = key[0];
		// html box为空
		box.innerHTML = '';
		dw.innerHTML = '';
		// 依次遍历排列好的每个字母
		key.forEach(ele => {
			// 在box添加h3元素和首字母
			box.innerHTML += `<h3>${ele}</h3>` ;
			// dw盒子添加首字母
			
			dw.innerHTML += `<li>${ele}</li>`

			// 遍历每个字母里的每条JSON数据
			obj[ele].forEach(elem =>{
				box.innerHTML += `<a href="tel:${elem.phone}">${elem.name}</a>`
			}) 
		})
	}

})
</script>